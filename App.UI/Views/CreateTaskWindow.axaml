<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:App.UI.ViewModels"
        x:Class="App.UI.Views.CreateTaskWindow"
        x:DataType="vm:CreateTaskViewModel"
        Title="Create Task"
        Width="550"
        Height="700"
        CanResize="False"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource PrimaryBgBrush}">

    <Border Padding="30" Background="{StaticResource SecondaryBgBrush}" CornerRadius="12" Margin="10">
        <ScrollViewer Padding="0,0,10,0">
            <StackPanel Spacing="18">
                <!-- Header -->
                <TextBlock Text="Create New Task"
                           FontSize="24"
                           FontWeight="Bold"
                           Foreground="{StaticResource HeadingTextBrush}"/>

                <!-- Task Type -->
                <StackPanel Spacing="6">
                    <TextBlock Text="Task Type *"
                               Foreground="{StaticResource LabelTextBrush}"
                               FontSize="13"/>
                    <ComboBox ItemsSource="{Binding TaskTypes}"
                              SelectedItem="{Binding SelectedTaskType}"
                              IsEnabled="{Binding !IsLoading}"
                              HorizontalAlignment="Stretch"/>
                </StackPanel>

                <!-- Title -->
                <StackPanel Spacing="6">
                    <TextBlock Text="Title *"
                               Foreground="{StaticResource LabelTextBrush}"
                               FontSize="13"/>
                    <TextBox Text="{Binding Title}"
                             Watermark="Enter task title"
                             IsEnabled="{Binding !IsLoading}"/>
                    <TextBlock Text="{Binding TitleError}"
                               Foreground="#f87171"
                               FontSize="12"
                               IsVisible="{Binding TitleError, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                </StackPanel>

                <!-- Description -->
                <StackPanel Spacing="6">
                    <TextBlock Text="Description"
                               Foreground="{StaticResource LabelTextBrush}"
                               FontSize="13"/>
                    <TextBox Text="{Binding Description}"
                             Watermark="Enter task description"
                             AcceptsReturn="True"
                             Height="100"
                             TextWrapping="Wrap"
                             IsEnabled="{Binding !IsLoading}"/>
                </StackPanel>

                <!-- Project -->
                <StackPanel Spacing="6">
                    <TextBlock Text="Project *"
                               Foreground="{StaticResource LabelTextBrush}"
                               FontSize="13"/>
                    <ComboBox ItemsSource="{Binding AvailableProjects}"
                              SelectedItem="{Binding SelectedProject}"
                              PlaceholderText="Select project..."
                              IsEnabled="{Binding !IsLoading}"
                              HorizontalAlignment="Stretch">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Name}"/>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    <TextBlock Text="{Binding ProjectError}"
                               Foreground="#f87171"
                               FontSize="12"
                               IsVisible="{Binding ProjectError, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                </StackPanel>

                <!-- Assigned To -->
                <StackPanel Spacing="6">
                    <TextBlock Text="Assign To"
                               Foreground="{StaticResource LabelTextBrush}"
                               FontSize="13"/>
                    <ComboBox ItemsSource="{Binding AvailableUsers}"
                              SelectedItem="{Binding SelectedAssignee}"
                              PlaceholderText="Unassigned"
                              IsEnabled="{Binding !IsLoading}"
                              HorizontalAlignment="Stretch">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock>
                                    <Run Text="{Binding FirstName}"/>
                                    <Run Text=" "/>
                                    <Run Text="{Binding LastName}"/>
                                </TextBlock>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </StackPanel>

                <!-- Status -->
                <StackPanel Spacing="6">
                    <TextBlock Text="Status *"
                               Foreground="{StaticResource LabelTextBrush}"
                               FontSize="13"/>
                    <ComboBox ItemsSource="{Binding AvailableStatuses}"
                              SelectedItem="{Binding SelectedStatus}"
                              IsEnabled="{Binding !IsLoading}"
                              HorizontalAlignment="Stretch"/>
                </StackPanel>

                <!-- Priority -->
                <StackPanel Spacing="6">
                    <TextBlock Text="Priority *"
                               Foreground="{StaticResource LabelTextBrush}"
                               FontSize="13"/>
                    <ComboBox ItemsSource="{Binding AvailablePriorities}"
                              SelectedItem="{Binding SelectedPriority}"
                              IsEnabled="{Binding !IsLoading}"
                              HorizontalAlignment="Stretch"/>
                </StackPanel>

                <!-- Success Message -->
                <Border Background="#1a3f1a"
                        BorderBrush="#4ade80"
                        BorderThickness="1"
                        CornerRadius="6"
                        Padding="12"
                        IsVisible="{Binding SuccessMessage, Converter={x:Static ObjectConverters.IsNotNull}}">
                    <TextBlock Text="{Binding SuccessMessage}"
                               Foreground="#4ade80"
                               TextWrapping="Wrap"
                               FontSize="12"/>
                </Border>

                <!-- Buttons -->
                <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Right" Margin="0,10,0,0">
                    <Button Content="Clear"
                            Command="{Binding ClearFormCommand}"
                            IsEnabled="{Binding !IsLoading}"
                            Classes="secondary"
                            Width="100"/>
                    <Button Content="Create Task"
                            Command="{Binding CreateTaskCommand}"
                            IsEnabled="{Binding !IsLoading}"
                            Width="120"/>
                </StackPanel>

                <!-- Loading Indicator -->
                <TextBlock Text="Creating task..."
                           Foreground="{StaticResource TabActiveBrush}"
                           FontSize="12"
                           HorizontalAlignment="Center"
                           IsVisible="{Binding IsLoading}"/>
            </StackPanel>
        </ScrollViewer>
    </Border>
</Window>
